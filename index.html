<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tools Pack — All-in-One Utilities (HTML • CSS • JS)</title>
    <meta
      name="description"
      content="Tools Pack: a fast, modern, responsive multi-tool website. Calculator, unit converter, text utilities, Base64, URL tools, JSON formatter, password/UUID/SHA-256 generators, image resizer, color contrast checker, timers, and quick notes — all in one file."
    />
    <meta name="theme-color" content="#1E1E2F" />

    <!--
    Google Ads Ready:
    1) Paste your AdSense script below (uncomment & replace with your own client id).
       <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXX" crossorigin="anonymous"></script>
    2) Replace each .ad-slot placeholder with your <ins class="adsbygoogle" ...> units and run (adsbygoogle = window.adsbygoogle || []).push({});
  -->

    <style>
      :root {
        --bg: #1e1e2f; /* Dark navy background */
        --card: #24243b; /* Card surface */
        --muted: #a0a3b1; /* Muted text */
        --text: #ededf7; /* Main text */
        --accent: #6c63ff; /* Accent (indigo) */
        --accent-2: #00e5a8; /* Accent secondary (teal) */
        --danger: #ff6b6b;
        --ok: #37e694;
        --border: 1px solid rgba(255, 255, 255, 0.08);
        --radius: 16px;
        --shadow: 0 10px 24px rgba(0, 0, 0, 0.35);
        --focus: 0 0 0 3px rgba(108, 99, 255, 0.45);
        --card-min-h: 420px;
      }

      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
          Inter, "Helvetica Neue", "Noto Sans", Arial, "Apple Color Emoji",
          "Segoe UI Emoji";
        background: radial-gradient(
            1200px 600px at 10% -10%,
            rgba(108, 99, 255, 0.15),
            transparent 60%
          ),
          radial-gradient(
            800px 400px at 100% 0%,
            rgba(0, 229, 168, 0.12),
            transparent 60%
          ),
          var(--bg);
        color: var(--text);
        line-height: 1.45;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      a {
        color: var(--accent-2);
        text-decoration: none;
      }
      a:focus-visible,
      button:focus-visible,
      input:focus-visible,
      textarea:focus-visible,
      select:focus-visible {
        outline: none;
        box-shadow: var(--focus);
        border-radius: 12px;
      }

      header {
        position: sticky;
        top: 0;
        z-index: 50;
        backdrop-filter: blur(10px);
        background: linear-gradient(
          to bottom,
          rgba(30, 30, 47, 0.9),
          rgba(30, 30, 47, 0.45)
        );
        border-bottom: var(--border);
      }
      .wrap {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .topbar {
        display: flex;
        gap: 16px;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
      }
      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
        white-space: nowrap;
      }
      .logo {
        width: 36px;
        height: 36px;
        border-radius: 10px;
        background: linear-gradient(135deg, var(--accent), var(--accent-2));
        box-shadow: 0 10px 30px rgba(108, 99, 255, 0.35),
          inset 0 0 18px rgba(0, 229, 168, 0.25);
      }
      .brand h1 {
        font-size: 20px;
        margin: 0;
        letter-spacing: 0.3px;
      }
      .sub {
        font-size: 12px;
        color: var(--muted);
      }

      .searchbar {
        position: relative;
        flex: 1;
        min-width: 240px;
        max-width: 520px;
      }
      .searchbar input {
        width: 100%;
        padding: 12px 44px;
        border-radius: 12px;
        border: var(--border);
        background: #1c1c2c;
        color: var(--text);
        transition: 0.2s box-shadow;
      }
      .searchbar .icon {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        opacity: 0.65;
      }
      .hotkey {
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 12px;
        color: var(--muted);
        border: var(--border);
        padding: 2px 6px;
        border-radius: 8px;
        background: #171727;
      }
      .actions {
        display: flex;
        gap: 10px;
      }
      .btn {
        padding: 10px 14px;
        border-radius: 12px;
        border: var(--border);
        background: #1c1c2c;
        color: var(--text);
        cursor: pointer;
        transition: transform 0.06s ease, box-shadow 0.2s ease,
          background 0.2s ease;
      }
      .btn:hover {
        background: #212136;
      }
      .btn:active {
        transform: translateY(1px) scale(0.99);
      }
      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--accent) 0%,
          #5a52ff 50%,
          #544cff 100%
        );
        border: none;
        box-shadow: 0 10px 20px rgba(108, 99, 255, 0.35);
      }
      .btn-ghost {
        background: transparent;
        border: var(--border);
      }

      .ad-slot {
        margin: 16px auto;
        max-width: 1200px;
        min-height: 190px;
        display: grid;
        place-items: center;
        border: 2px dashed rgba(255, 255, 255, 0.12);
        border-radius: 14px;
        color: var(--muted);
        font-size: 14px;
        text-align: center;
        background: rgba(255, 255, 255, 0.02);
      }

      main {
        padding: 16px 0 64px;
      }

      .grid {
        display: grid;
        gap: 16px;
        grid-template-columns: repeat(12, 1fr);
      }

      /* ✅ Fix: two cards center nicely by filling 12 columns (6 + 6) */
      .tool-card {
        grid-column: span 6;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.03),
          rgba(255, 255, 255, 0.01)
        );
        border: var(--border);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 16px;
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        gap: 12px;
        transition: 0.25s transform, 0.25s box-shadow, 0.25s background;
        min-height: var(--card-min-h);
      }
      .tool-card:hover {
        transform: translateY(-2px);
      }
      .tool-head {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
      }
      .tool-title {
        font-size: 36px;
        letter-spacing: 0.3px;
        margin: 0;
      }
      .tool-body {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .muted {
        color: var(--muted);
      }
      .row {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      .row > * {
        flex: 1;
      }
      .field,
      .textarea,
      .select {
        background: #161627;
        color: var(--text);
        border: var(--border);
        border-radius: 12px;
        padding: 10px 12px;
        width: 100%;
      }
      .textarea {
        min-height: 110px;
        resize: vertical;
        line-height: 1.35;
      }
      .mono {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
      }
      .pill {
        font-size: 12px;
        color: #cfcff8;
        background: #1b1b2c;
        border: var(--border);
        padding: 4px 8px;
        border-radius: 999px;
      }
      .split {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }
      .center {
        display: grid;
        place-items: center;
      }
      .copygroup {
        display: flex;
        gap: 10px;
      }
      .small {
        font-size: 12px;
      }
      .status {
        font-size: 13px;
      }
      .ok {
        color: var(--ok);
      }
      .bad {
        color: var(--danger);
      }

      footer {
        border-top: var(--border);
        padding: 28px 0;
        color: var(--muted);
        text-align: center;
      }
      .kbd {
        font-family: ui-monospace, Menlo, Consolas, monospace;
        font-size: 12px;
        border: var(--border);
        padding: 2px 6px;
        border-radius: 6px;
        background: #161627;
      }

      /* Command Palette (Ctrl/Cmd + K) */
      .palette {
        position: fixed;
        inset: 0;
        z-index: 100;
        display: none;
        background: rgba(0, 0, 0, 0.5);
      }
      .palette[aria-hidden="false"] {
        display: block;
      }
      .palette .box {
        max-width: 640px;
        margin: 10vh auto;
        background: #121226;
        border-radius: 14px;
        border: var(--border);
        box-shadow: var(--shadow);
        overflow: hidden;
      }
      .palette .box header {
        border: none;
        position: relative;
        background: #121226;
      }
      .palette .input {
        width: 100%;
        padding: 14px 16px;
        border: none;
        outline: none;
        background: #121226;
        color: var(--text);
        font-size: 16px;
      }
      .palette .list {
        max-height: 50vh;
        overflow: auto;
        border-top: var(--border);
      }
      .palette .item {
        padding: 12px 16px;
        border-bottom: var(--border);
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .palette .item[aria-selected="true"] {
        background: #1a1a34;
      }
      .palette .item small {
        color: var(--muted);
      }

      /* Responsive */
      @media (max-width: 1100px) {
        .tool-card {
          grid-column: span 6;
        }
      }
      @media (max-width: 720px) {
        .grid {
          grid-template-columns: repeat(6, 1fr);
        }
        .tool-card {
          grid-column: span 6;
        }
        .split {
          grid-template-columns: 1fr;
        }
      }

      .row1 {
        flex-direction: column;
      }
    </style>
  </head>
  <body>
    <header>
      <div class="wrap topbar" role="banner" aria-label="Top navigation">
        <div class="brand" aria-label="Brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <h1 class="tool-title" style="font-size: 18px; margin: 0">
              Tools Pack
            </h1>
            <div class="sub">Minimal • Fast • All-in-One</div>
          </div>
        </div>

        <div class="searchbar" role="search">
          <svg
            class="icon"
            width="18"
            height="18"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path
              fill="currentColor"
              d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.5 21.5 20zM4 9.5C4 6.46 6.46 4 9.5 4S15 6.46 15 9.5 12.54 15 9.5 15 4 12.54 4 9.5"
            ></path>
          </svg>
          <input
            id="globalSearch"
            class="field"
            type="text"
            placeholder="Search tools… (try: json, hash, color)"
            aria-label="Search tools by name"
          />
          <div class="hotkey" aria-hidden="true">Ctrl ⌃ / ⌘ + K</div>
        </div>

        <div class="actions">
          <button
            class="btn btn-ghost"
            id="openPalette"
            aria-label="Open command palette"
          >
            Command Palette
          </button>
          <button
            class="btn btn-primary"
            title="Star this project in your bookmarks"
          >
            ⭐️ Star
          </button>
        </div>
      </div>
    </header>

    <div class="ad-slot" aria-label="Ad slot placeholder">
      <!-- Replace this with your <ins class="adsbygoogle"> unit -->
      <span>Ad Slot • Responsive • Place your AdSense unit here</span>
    </div>

    <main class="wrap" id="main" role="main">
      <section id="tools" class="grid" aria-live="polite">
        <!-- 14) Age Calculator -->
        <article
          class="tool-card"
          id="tool-age"
          data-name="Age Calculator"
          data-tags="age birthday date calculator"
        >
          <div class="tool-head">
            <h2 class="tool-title">Age Calculator</h2>
            <span class="pill">years • months • days</span>
          </div>

          <div class="tool-body">
            <div class="row row1">
              <label
                class="field"
                style="display: flex; align-items: center; gap: 10px"
              >
                <span class="small muted">Date of birth</span>
                <input
                  id="ageDob"
                  class="field"
                  type="date"
                  aria-label="Date of birth"
                />
              </label>
              <label
                class="field"
                style="display: flex; align-items: center; gap: 10px"
              >
                <span class="small muted">Age of</span>
                <input
                  id="ageAsOf"
                  class="field"
                  type="date"
                  aria-label="As of date"
                />
              </label>
            </div>

            <div class="row">
              <button class="btn" id="ageCalc">Calculate</button>
              <button class="btn" id="ageReset">Reset</button>
              <button class="btn" id="ageCopy">Copy</button>
            </div>

            <output
              id="ageOut"
              class="field mono"
              aria-live="polite"
              title="Age breakdown"
              style="user-select: text"
            ></output>

            <div
              class="field"
              style="display: flex; flex-direction: column; gap: 6px"
            >
              <div class="small muted">Next birthday</div>
              <div id="ageNextVal" class="mono"></div>
            </div>

            <div class="small muted" id="ageMsg">
              Feb 29 birthdays are treated as Feb 28 in non-leap years.
            </div>
          </div>
        </article>

        <!-- 1) Calculator -->
        <article
          class="tool-card"
          id="tool-calculator"
          data-name="Calculator"
          data-tags="math arithmetic calc"
        >
          <div class="tool-head">
            <h2 class="tool-title">Calculator</h2>
            <span class="pill mono">basic arithmetic</span>
          </div>
          <div class="tool-body">
            <!-- Changed from <input> to <textarea> -->
            <textarea
              id="calcExpr"
              class="field mono"
              aria-label="Expression"
              placeholder="Enter expression, e.g. (3+5)*2/4 - 1"
              rows="5"
              style="resize: vertical"
            ></textarea>

            <div class="row">
              <button id="calcEval" class="btn">Evaluate</button>
              <button id="calcClear" class="btn">Clear</button>
            </div>

            <output
              id="calcOut"
              class="field mono"
              aria-live="polite"
              style="user-select: all"
              title="Result will appear here"
            ></output>
            <div class="small muted">
              Tip: Allowed chars 0-9, + − × ÷ ( ) . %
            </div>
          </div>
        </article>

        <!-- 2) Unit Converter -->
        <article
          class="tool-card"
          id="tool-unit"
          data-name="Unit Converter"
          data-tags="convert length weight temperature units"
        >
          <div class="tool-head">
            <h2 class="tool-title">Unit Converter</h2>
            <span class="pill">length • weight • temp</span>
          </div>
          <div class="tool-body">
            <div class="row">
              <select id="ucCategory" class="select" aria-label="Category">
                <option value="length">Length</option>
                <option value="weight">Weight</option>
                <option value="temperature">Temperature</option>
              </select>
              <input
                id="ucValue"
                class="field"
                type="number"
                step="any"
                placeholder="Value"
                aria-label="Value"
              />
            </div>
            <div class="row">
              <select
                id="ucFrom"
                class="select"
                aria-label="From unit"
              ></select>
              <select id="ucTo" class="select" aria-label="To unit"></select>
            </div>
            <output
              id="ucResult"
              class="field mono"
              aria-live="polite"
              title="Converted value"
            ></output>
          </div>
        </article>

        <!-- 3) Text Utilities -->
        <article
          class="tool-card"
          id="tool-text"
          data-name="Text Utilities"
          data-tags="text uppercase lowercase word count remove spaces"
        >
          <div class="tool-head">
            <h2 class="tool-title">Text Utilities</h2>
            <span class="pill">clean • case • count</span>
          </div>
          <div class="tool-body">
            <textarea
              id="txtIn"
              class="textarea"
              aria-label="Text input"
              placeholder="Paste or type your text here…"
            ></textarea>
            <div class="row">
              <button class="btn" id="txtUpper">UPPERCASE</button>
              <button class="btn" id="txtLower">lowercase</button>
              <button class="btn" id="txtCollapse">Collapse spaces</button>
              <button class="btn" id="txtRemoveSpaces">
                Remove ALL spaces
              </button>
              <button class="btn" id="txtCopy">Copy</button>
            </div>
            <div class="status muted small" id="txtStats">
              Words: 0 • Characters: 0
            </div>
          </div>
        </article>

        <!-- 4) Base64 -->
        <article
          class="tool-card"
          id="tool-b64"
          data-name="Base64 Encode Decode"
          data-tags="base64 encode decode"
        >
          <div class="tool-head">
            <h2 class="tool-title">Base64 Encode / Decode</h2>
            <span class="pill mono">Text ⇄ Base64</span>
          </div>
          <div class="tool-body">
            <textarea
              id="b64Input"
              class="textarea mono"
              aria-label="Input text or Base64"
            ></textarea>
            <div class="row">
              <button class="btn" id="b64Enc">Encode</button>
              <button class="btn" id="b64Dec">Decode</button>
              <button class="btn" id="b64Copy">Copy Output</button>
            </div>
            <textarea
              id="b64Output"
              class="textarea mono"
              readonly
              aria-label="Output"
            ></textarea>
          </div>
        </article>

        <!-- 5) URL Encoder/Decoder -->
        <article
          class="tool-card"
          id="tool-url"
          data-name="URL Encoder Decoder"
          data-tags="url encode decode uri component"
        >
          <div class="tool-head">
            <h2 class="tool-title">URL Encoder / Decoder</h2>
            <span class="pill mono">URI Component</span>
          </div>
          <div class="tool-body">
            <textarea
              id="urlInput"
              class="textarea mono"
              aria-label="URL input or text"
            ></textarea>
            <div class="row">
              <button class="btn" id="urlEnc">Encode</button>
              <button class="btn" id="urlDec">Decode</button>
              <button class="btn" id="urlCopy">Copy Output</button>
            </div>
            <textarea
              id="urlOutput"
              class="textarea mono"
              readonly
              aria-label="Output"
            ></textarea>
          </div>
        </article>

        <!-- 6) JSON Formatter/Validator -->
        <article
          class="tool-card"
          id="tool-json"
          data-name="JSON Formatter Validator"
          data-tags="json format pretty validate"
        >
          <div class="tool-head">
            <h2 class="tool-title">JSON Formatter / Validator</h2>
            <span class="pill mono">pretty • minify</span>
          </div>
          <div class="tool-body">
            <textarea
              id="jsonInput"
              class="textarea mono"
              aria-label="JSON input"
              placeholder='{"hello": "world"}'
            ></textarea>
            <div class="row">
              <button class="btn" id="jsonFormat">Format</button>
              <button class="btn" id="jsonMinify">Minify</button>
              <button class="btn" id="jsonValidate">Validate</button>
              <button class="btn" id="jsonCopy">Copy Output</button>
            </div>
            <textarea
              id="jsonOutput"
              class="textarea mono"
              readonly
              aria-label="JSON output"
            ></textarea>
            <div
              id="jsonStatus"
              class="small status muted"
              aria-live="polite"
            ></div>
          </div>
        </article>

        <!-- 7) Password Generator -->
        <article
          class="tool-card"
          id="tool-pass"
          data-name="Password Generator"
          data-tags="password generator random secure"
        >
          <div class="tool-head">
            <h2 class="tool-title">Password Generator</h2>
            <span class="pill mono">crypto-secure</span>
          </div>
          <div class="tool-body">
            <div class="row">
              <label
                class="field"
                style="display: flex; align-items: center; gap: 10px"
              >
                <span class="small muted">Length</span>
                <input
                  id="pwLen"
                  type="range"
                  min="8"
                  max="128"
                  value="16"
                  aria-label="Password length"
                />
                <span class="pill mono" id="pwLenVal">16</span>
              </label>
            </div>
            <div class="row">
              <label class="pill"
                ><input
                  id="pwLower"
                  type="checkbox"
                  checked
                  aria-label="Include lowercase"
                />
                a-z</label
              >
              <label class="pill"
                ><input
                  id="pwUpper"
                  type="checkbox"
                  checked
                  aria-label="Include uppercase"
                />
                A-Z</label
              >
              <label class="pill"
                ><input
                  id="pwNum"
                  type="checkbox"
                  checked
                  aria-label="Include digits"
                />
                0-9</label
              >
              <label class="pill"
                ><input
                  id="pwSym"
                  type="checkbox"
                  checked
                  aria-label="Include symbols"
                />
                !@#$…</label
              >
            </div>
            <div class="copygroup">
              <input
                id="pwOut"
                class="field mono"
                readonly
                aria-label="Generated password"
              />
              <button class="btn" id="pwGen">Generate</button>
              <button class="btn" id="pwCopy">Copy</button>
            </div>
          </div>
        </article>

        <!-- 8) UUID v4 -->
        <article
          class="tool-card"
          id="tool-uuid"
          data-name="UUID Generator"
          data-tags="uuid v4 guid"
        >
          <div class="tool-head">
            <h2 class="tool-title">UUID v4 Generator</h2>
            <span class="pill mono">RFC 4122</span>
          </div>
          <div class="tool-body">
            <div class="copygroup">
              <input
                id="uuidOut"
                class="field mono"
                readonly
                aria-label="UUID value"
              />
              <button class="btn" id="uuidGen">Generate</button>
              <button class="btn" id="uuidCopy">Copy</button>
            </div>
          </div>
        </article>

        <!-- 9) Hash Generator (SHA-256) -->
        <article
          class="tool-card"
          id="tool-hash"
          data-name="Hash Generator SHA-256"
          data-tags="hash sha256 digest webcrypto"
        >
          <div class="tool-head">
            <h2 class="tool-title">Hash Generator</h2>
            <span class="pill mono">SHA-256 • WebCrypto</span>
          </div>
          <div class="tool-body">
            <textarea
              id="hashText"
              class="textarea mono"
              placeholder="Text to hash (or choose a file below)…"
              aria-label="Text to hash"
            ></textarea>
            <div class="row">
              <input
                id="hashFile"
                class="field"
                type="file"
                aria-label="File to hash"
              />
              <button class="btn" id="hashRun">Compute SHA-256</button>
            </div>
            <input
              id="hashOut"
              class="field mono"
              readonly
              aria-label="SHA-256 hex digest"
            />
          </div>
        </article>

        <!-- 10) Image Resizer & Compressor -->
        <article
          class="tool-card"
          id="tool-image"
          data-name="Image Resizer Compressor"
          data-tags="image resize compress canvas photo webp jpg png"
        >
          <div class="tool-head">
            <h2 class="tool-title">Image Resizer & Compressor</h2>
            <span class="pill">Canvas • JPG/PNG/WebP</span>
          </div>
          <div class="tool-body">
            <div class="row">
              <input
                id="imgFile"
                class="field"
                type="file"
                accept="image/*"
                aria-label="Upload image"
              />
            </div>
            <div class="split">
              <div
                class="center"
                style="
                  min-height: 150px;
                  background: #151527;
                  border-radius: 12px;
                  border: var(--border);
                "
              >
                <img
                  id="imgPreview"
                  alt="Preview"
                  style="
                    max-width: 100%;
                    max-height: 220px;
                    display: none;
                    border-radius: 10px;
                  "
                />
                <span id="imgEmpty" class="muted small"
                  >Upload an image to preview…</span
                >
              </div>
              <div
                class="field"
                style="display: flex; flex-direction: column; gap: 10px"
              >
                <div class="row">
                  <label class="pill"
                    >W
                    <input
                      id="imgW"
                      type="number"
                      class="field"
                      min="1"
                      step="1"
                      aria-label="Width"
                  /></label>
                  <label class="pill"
                    >H
                    <input
                      id="imgH"
                      type="number"
                      class="field"
                      min="1"
                      step="1"
                      aria-label="Height"
                  /></label>
                </div>
                <label class="pill"
                  ><input
                    id="imgKeep"
                    type="checkbox"
                    checked
                    aria-label="Keep aspect ratio"
                  />
                  Keep aspect ratio</label
                >
                <div class="row">
                  <select
                    id="imgFormat"
                    class="select"
                    aria-label="Output format"
                  >
                    <option value="image/jpeg">JPEG</option>
                    <option value="image/png">PNG</option>
                    <option value="image/webp">WebP</option>
                  </select>
                  <label
                    class="field"
                    style="display: flex; align-items: center; gap: 10px"
                  >
                    <span class="small muted">Quality</span>
                    <input
                      id="imgQ"
                      type="range"
                      min="0.1"
                      max="1"
                      step="0.05"
                      value="0.8"
                      aria-label="Quality"
                    />
                    <span class="pill mono" id="imgQVal">0.80</span>
                  </label>
                </div>
                <div class="row">
                  <button id="imgAuto" class="btn">Auto size</button>
                  <button id="imgRun" class="btn">Resize & Download</button>
                </div>
                <div id="imgInfo" class="small muted"></div>
              </div>
            </div>
            <canvas id="imgCanvas" style="display: none"></canvas>
          </div>
        </article>

        <!-- 11) Color Picker + Contrast -->
        <article
          class="tool-card"
          id="tool-color"
          data-name="Color Picker Contrast Checker"
          data-tags="color picker contrast wcag accessibility"
        >
          <div class="tool-head">
            <h2 class="tool-title">Color Picker + Contrast Checker</h2>
            <span class="pill">WCAG 2.1</span>
          </div>
          <div class="tool-body">
            <div class="row">
              <label
                class="field"
                style="display: flex; align-items: center; gap: 10px"
              >
                <input
                  id="cFg"
                  type="color"
                  value="#FFFFFF"
                  aria-label="Foreground color"
                />
                <input
                  id="cFgHex"
                  class="field mono"
                  value="#FFFFFF"
                  aria-label="Foreground hex"
                />
                <button class="btn" data-copy="#cFgHex">Copy</button>
              </label>
              <label
                class="field"
                style="display: flex; align-items: center; gap: 10px"
              >
                <input
                  id="cBg"
                  type="color"
                  value="#000000"
                  aria-label="Background color"
                />
                <input
                  id="cBgHex"
                  class="field mono"
                  value="#000000"
                  aria-label="Background hex"
                />
                <button class="btn" data-copy="#cBgHex">Copy</button>
              </label>
            </div>
            <div class="split">
              <div
                class="field"
                style="padding: 16px; border-radius: 12px"
                id="sampleA"
              >
                <div class="small muted">Sample (Normal text)</div>
                <div>Almost before we knew it, we had left the ground.</div>
              </div>
              <div
                class="field"
                style="padding: 16px; border-radius: 12px"
                id="sampleB"
              >
                <div class="small muted">Sample (Large text)</div>
                <div style="font-size: 20px; font-weight: 700">
                  Sphinx of black quartz, judge my vow.
                </div>
              </div>
            </div>
            <div id="contrastResult" class="status"></div>
          </div>
        </article>

        <!-- 12) Stopwatch & Countdown -->
        <article
          class="tool-card"
          id="tool-time"
          data-name="Stopwatch Countdown Timer"
          data-tags="time stopwatch countdown timer"
        >
          <div class="tool-head">
            <h2 class="tool-title">Stopwatch & Countdown</h2>
            <span class="pill">precise timing</span>
          </div>
          <div class="tool-body">
            <div
              class="field center"
              style="font-size: 28px; font-weight: 700"
              id="swDisplay"
              aria-live="polite"
            >
              00:00.000
            </div>
            <div class="row">
              <button class="btn" id="swStart">Start</button>
              <button class="btn" id="swPause">Pause</button>
              <button class="btn" id="swReset">Reset</button>
            </div>
            <hr style="border: none; border-top: var(--border)" />
            <div class="row">
              <input
                id="cdMin"
                class="field"
                type="number"
                min="0"
                value="0"
                aria-label="Minutes"
                placeholder="Minutes"
              />
              <input
                id="cdSec"
                class="field"
                type="number"
                min="0"
                max="59"
                value="30"
                aria-label="Seconds"
                placeholder="Seconds"
              />
            </div>
            <div class="row">
              <button class="btn" id="cdStart">Start Countdown</button>
              <button class="btn" id="cdStop">Stop</button>
            </div>
            <div id="cdDisplay" class="field center" aria-live="polite">
              00:30
            </div>
          </div>
        </article>

        <!-- 13) Quick Notes (localStorage) -->
        <article
          class="tool-card"
          id="tool-notes"
          data-name="Quick Notes"
          data-tags="notes localstorage sticky"
        >
          <div class="tool-head">
            <h2 class="tool-title">Quick Notes</h2>
            <span class="pill">auto-save</span>
          </div>
          <div class="tool-body">
            <textarea
              id="notesArea"
              class="textarea"
              aria-label="Notes"
              placeholder="Write anything… It's saved automatically to your browser."
            ></textarea>
            <div class="row">
              <button class="btn" id="notesClear">Clear</button>
              <button class="btn" id="notesExport">Export .txt</button>
              <label class="btn" for="notesImportFile" style="cursor: pointer"
                >Import</label
              >
              <input
                id="notesImportFile"
                type="file"
                accept=".txt,text/plain"
                style="display: none"
              />
            </div>
            <div class="small muted" id="notesStatus">Saved.</div>
          </div>
        </article>

        <!-- Text → PDF -->
        <article
          class="tool-card"
          id="tool-pdf"
          data-name="Text to PDF"
          data-tags="pdf text print export"
        >
          <div class="tool-head">
            <h2 class="tool-title">Text → PDF</h2>
            <span class="pill">Unicode-safe • print to PDF</span>
          </div>

          <div class="tool-body">
            <div class="row">
              <input
                id="pdfFileName"
                class="field mono"
                placeholder="Filename (e.g., notes.pdf)"
                aria-label="Filename"
              />
            </div>

            <div class="row">
              <select id="pdfPage" class="select" aria-label="Page size">
                <option value="A4">A4 (210×297 mm)</option>
                <option value="Letter">Letter (8.5×11 in)</option>
                <option value="Legal">Legal (8.5×14 in)</option>
              </select>
              <select id="pdfOrient" class="select" aria-label="Orientation">
                <option value="portrait">Portrait</option>
                <option value="landscape">Landscape</option>
              </select>
              <select id="pdfFont" class="select" aria-label="Font family">
                <option value="system-ui">System UI</option>
                <option value="serif">Serif</option>
                <option value="monospace">Monospace</option>
              </select>
              <label
                class="field"
                style="display: flex; align-items: center; gap: 10px"
              >
                <span class="small muted">Font size</span>
                <input
                  id="pdfSize"
                  type="number"
                  class="field"
                  value="12"
                  min="8"
                  max="24"
                  step="1"
                  aria-label="Font size (pt)"
                />
                <span class="pill mono">pt</span>
              </label>
            </div>

            <div class="row">
              <label
                class="field"
                style="display: flex; align-items: center; gap: 10px"
              >
                <span class="small muted">Margins</span>
                <input
                  id="pdfMargin"
                  type="number"
                  class="field"
                  value="15"
                  min="5"
                  max="40"
                  step="1"
                  aria-label="Margins (mm)"
                />
                <span class="pill mono">mm</span>
              </label>
              <label
                class="field"
                style="display: flex; align-items: center; gap: 10px"
              >
                <span class="small muted">Line height</span>
                <input
                  id="pdfLine"
                  type="number"
                  class="field"
                  value="1.5"
                  min="1"
                  max="2.4"
                  step="0.1"
                  aria-label="Line height"
                />
              </label>
              <label class="pill"
                ><input id="pdfHeaderOn" type="checkbox" checked />
                Header</label
              >
              <label class="pill"
                ><input id="pdfFooterOn" type="checkbox" /> Footer</label
              >
            </div>

            <textarea
              id="pdfText"
              class="textarea"
              aria-label="Text to convert to PDF"
              placeholder="Type or paste your text here… Supports Bangla/Unicode/emoji ✅"
            ></textarea>

            <div class="row">
              <button class="btn" id="pdfPreview">Preview & Print</button>
              <button class="btn" id="pdfClear">Clear</button>
              <button class="btn" id="pdfSample">Sample</button>
            </div>

            <div id="pdfStatus" class="small muted">
              Tip: Use your browser’s “Save as PDF” in the print dialog.
            </div>
          </div>
        </article>
      </section>
    </main>

    <div class="ad-slot" aria-label="Ad slot placeholder">
      <!-- Replace with <ins class="adsbygoogle"> and push() -->
      <span>Ad Slot • In-content • Place your AdSense unit here</span>
    </div>

    <footer>
      <div class="wrap">
        Made with ♥ for the web. Use <span class="kbd">Ctrl</span>/<span
          class="kbd"
          >⌘</span
        >
        + <span class="kbd">K</span> for quick navigation.
      </div>
    </footer>

    <!-- Command Palette -->
    <div
      id="palette"
      class="palette"
      aria-hidden="true"
      role="dialog"
      aria-modal="true"
      aria-label="Command palette"
    >
      <div class="box">
        <header class="wrap">
          <input
            id="paletteInput"
            class="input"
            type="text"
            placeholder="Type to jump to a tool…"
            aria-label="Command input"
          />
        </header>
        <div
          id="paletteList"
          class="list"
          role="listbox"
          aria-label="Tools list"
        ></div>
      </div>
    </div>

    <script>
      /* ===========================================================
       Helpers & Essentials
    ============================================================ */
      const $ = (sel, el = document) => el.querySelector(sel);
      const $$ = (sel, el = document) => Array.from(el.querySelectorAll(sel));
      const copy = async (text) => {
        try {
          await navigator.clipboard.writeText(text);
          toast("Copied");
        } catch (e) {
          alert("Copy failed");
        }
      };
      const toast = (msg) => {
        const n = document.createElement("div");
        n.textContent = msg;
        n.style.cssText =
          "position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#111327;border:var(--border);padding:10px 14px;border-radius:10px;color:var(--text);z-index:200;box-shadow:var(--shadow)";
        document.body.appendChild(n);
        setTimeout(() => {
          n.remove();
        }, 1200);
      };
      const sanitizeExpr = (s) => /^[0-9+\-*/().% \t]+$/.test(s);

      const textEncoder = new TextEncoder();
      const textDecoder = new TextDecoder();

      const humanBytes = (n) => {
        if (!isFinite(n)) return "-";
        const u = ["B", "KB", "MB", "GB"];
        let i = 0;
        while (n >= 1024 && i < u.length - 1) {
          n /= 1024;
          i++;
        }
        return n.toFixed(1) + " " + u[i];
      };

      /* ===========================================================
       Global Search (filter cards)
    ============================================================ */
      const searchBox = $("#globalSearch");
      const cards = $$(".tool-card");
      const filterCards = (q) => {
        const s = q.trim().toLowerCase();
        let shown = 0;
        cards.forEach((card) => {
          const name = (card.dataset.name || "").toLowerCase();
          const tags = (card.dataset.tags || "").toLowerCase();
          const hit = !s || name.includes(s) || tags.includes(s);
          card.style.display = hit ? "" : "none";
          if (hit) shown++;
        });
        // Show/hide ad slots responsively based on results (optional)
        $$(".ad-slot").forEach(
          (el) => (el.style.display = shown ? "" : "none")
        );
      };
      searchBox.addEventListener("input", (e) => filterCards(e.target.value));

      /* ===========================================================
       Command Palette (Ctrl/Cmd + K)
    ============================================================ */
      const palette = $("#palette");
      const pInput = $("#paletteInput");
      const pList = $("#paletteList");
      const openPalette = () => {
        palette.setAttribute("aria-hidden", "false");
        buildPalette("");
        setTimeout(() => pInput.focus(), 0);
      };
      const closePalette = () => {
        palette.setAttribute("aria-hidden", "true");
        pInput.value = "";
        pList.innerHTML = "";
        searchBox.focus();
      };
      $("#openPalette").addEventListener("click", openPalette);
      document.addEventListener("keydown", (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === "k") {
          e.preventDefault();
          openPalette();
        }
        if (
          e.key === "Escape" &&
          palette.getAttribute("aria-hidden") === "false"
        ) {
          closePalette();
        }
      });

      const tools = cards.map((c) => ({
        id: c.id,
        name: c.dataset.name,
        tags: c.dataset.tags || "",
      }));
      let pIndex = 0;
      const buildPalette = (q) => {
        const s = q.trim().toLowerCase();
        const res = tools.filter(
          (t) =>
            !s ||
            t.name.toLowerCase().includes(s) ||
            t.tags.toLowerCase().includes(s)
        );
        pList.innerHTML = "";
        res.forEach((t, i) => {
          const el = document.createElement("div");
          el.className = "item";
          el.setAttribute("role", "option");
          el.setAttribute("aria-selected", i === 0 ? "true" : "false");
          el.innerHTML = `<span>${t.name}</span><small>#${t.id.replace(
            "tool-",
            ""
          )}</small>`;
          el.addEventListener("click", () => jumpTo(t.id));
          pList.appendChild(el);
        });
        pIndex = 0;
      };
      const setActive = (i) => {
        $$(".palette .item").forEach((el, idx) =>
          el.setAttribute("aria-selected", idx === i ? "true" : "false")
        );
        pIndex = i;
      };
      const jumpTo = (id) => {
        closePalette();
        const el = document.getElementById(id);
        if (!el) return;
        el.scrollIntoView({ behavior: "smooth", block: "center" });
        el.animate(
          [
            { outline: "2px solid transparent" },
            { outline: "2px solid var(--accent)" },
            { outline: "2px solid transparent" },
          ],
          { duration: 1200 }
        );
      };
      pInput.addEventListener("input", (e) => buildPalette(e.target.value));
      pInput.addEventListener("keydown", (e) => {
        const items = $$(".palette .item");
        if (!items.length) return;
        if (e.key === "ArrowDown") {
          e.preventDefault();
          setActive(Math.min(pIndex + 1, items.length - 1));
          items[pIndex].scrollIntoView({ block: "nearest" });
        }
        if (e.key === "ArrowUp") {
          e.preventDefault();
          setActive(Math.max(pIndex - 1, 0));
          items[pIndex].scrollIntoView({ block: "nearest" });
        }
        if (e.key === "Enter") {
          e.preventDefault();
          items[pIndex].click();
        }
        if (e.key === "Escape") {
          e.preventDefault();
          closePalette();
        }
      });
      palette.addEventListener("click", (e) => {
        if (e.target === palette) closePalette();
      });

      /* ===========================================================
       1) Calculator
    ============================================================ */
      $("#calcEval").addEventListener("click", () => {
        const expr = $("#calcExpr")
          .value.trim()
          .replace(/[×]/g, "*")
          .replace(/[÷]/g, "/");
        if (!expr) {
          $("#calcOut").value = "";
          return;
        }
        if (!sanitizeExpr(expr)) {
          $("#calcOut").value = "Error: invalid characters.";
          return;
        }
        try {
          // Safe-ish evaluation
          // eslint-disable-next-line no-new-func
          const res = Function(`"use strict"; return (${expr})`)();
          $("#calcOut").value = String(res);
        } catch (err) {
          $("#calcOut").value = "Error: " + err.message;
        }
      });
      $("#calcClear").addEventListener("click", () => {
        $("#calcExpr").value = "";
        $("#calcOut").value = "";
      });
      $("#calcExpr").addEventListener("keydown", (e) => {
        if (e.key === "Enter") $("#calcEval").click();
      });

      /* ===========================================================
       2) Unit Converter
    ============================================================ */
      const units = {
        length: {
          // base: meter
          m: 1,
          km: 1000,
          cm: 0.01,
          mm: 0.001,
          mi: 1609.344,
          yd: 0.9144,
          ft: 0.3048,
          in: 0.0254,
        },
        weight: {
          // base: kilogram
          kg: 1,
          g: 0.001,
          mg: 0.000001,
          lb: 0.45359237,
          oz: 0.028349523125,
          tonne: 1000,
        },
        temperature: ["C", "F", "K"],
      };
      const populateUnits = (cat) => {
        const from = $("#ucFrom"),
          to = $("#ucTo");
        from.innerHTML = "";
        to.innerHTML = "";
        if (cat === "temperature") {
          for (const u of units.temperature) {
            from.add(new Option(u, u));
            to.add(new Option(u, u));
          }
        } else {
          for (const u of Object.keys(units[cat])) {
            from.add(new Option(u, u));
            to.add(new Option(u, u));
          }
        }
        from.value = cat === "temperature" ? "C" : Object.keys(units[cat])[0];
        to.value = cat === "temperature" ? "F" : Object.keys(units[cat])[1];
      };
      const convertValue = () => {
        const cat = $("#ucCategory").value;
        const val = parseFloat($("#ucValue").value);
        const from = $("#ucFrom").value;
        const to = $("#ucTo").value;
        if (Number.isNaN(val)) {
          $("#ucResult").value = "";
          return;
        }
        let out = "";
        if (cat === "temperature") {
          let c;
          if (from === "C") c = val;
          if (from === "F") c = (val - 32) / 1.8;
          if (from === "K") c = val - 273.15;
          if (to === "C") out = c;
          if (to === "F") out = c * 1.8 + 32;
          if (to === "K") out = c + 273.15;
        } else {
          const base = val * units[cat][from]; // to base
          out = base / units[cat][to];
        }
        $("#ucResult").value = String(+out.toFixed(8));
      };
      $("#ucCategory").addEventListener("change", () => {
        populateUnits($("#ucCategory").value);
        convertValue();
      });
      ["#ucValue", "#ucFrom", "#ucTo"].forEach((sel) =>
        $(sel).addEventListener("input", convertValue)
      );
      populateUnits("length");
      convertValue();

      /* ===========================================================
       3) Text Utilities
    ============================================================ */
      const txt = $("#txtIn"),
        txtStats = $("#txtStats");
      const updateStats = () => {
        const s = txt.value;
        const words = (s.trim().match(/\S+/g) || []).length;
        const chars = s.length;
        txtStats.textContent = `Words: ${words} • Characters: ${chars}`;
      };
      txt.addEventListener("input", updateStats);
      updateStats();
      $("#txtUpper").addEventListener("click", () => {
        txt.value = txt.value.toUpperCase();
        updateStats();
      });
      $("#txtLower").addEventListener("click", () => {
        txt.value = txt.value.toLowerCase();
        updateStats();
      });
      $("#txtCollapse").addEventListener("click", () => {
        txt.value = txt.value.replace(/\s+/g, " ").trim();
        updateStats();
      });
      $("#txtRemoveSpaces").addEventListener("click", () => {
        txt.value = txt.value.replace(/ +/g, "");
        updateStats();
      });
      $("#txtCopy").addEventListener("click", () => copy(txt.value));

      /* ===========================================================
       4) Base64 Encode/Decode (Unicode-safe)
    ============================================================ */
      const b64enc = (str) => btoa(unescape(encodeURIComponent(str)));
      const b64dec = (str) => decodeURIComponent(escape(atob(str)));
      $("#b64Enc").addEventListener("click", () => {
        $("#b64Output").value = b64enc($("#b64Input").value);
      });
      $("#b64Dec").addEventListener("click", () => {
        try {
          $("#b64Output").value = b64dec($("#b64Input").value.trim());
        } catch (e) {
          $("#b64Output").value = "Decode error: " + e.message;
        }
      });
      $("#b64Copy").addEventListener("click", () =>
        copy($("#b64Output").value)
      );

      /* ===========================================================
       5) URL Encode/Decode
    ============================================================ */
      $("#urlEnc").addEventListener("click", () => {
        $("#urlOutput").value = encodeURIComponent($("#urlInput").value);
      });
      $("#urlDec").addEventListener("click", () => {
        try {
          $("#urlOutput").value = decodeURIComponent($("#urlInput").value);
        } catch (e) {
          $("#urlOutput").value = "Decode error: " + e.message;
        }
      });
      $("#urlCopy").addEventListener("click", () =>
        copy($("#urlOutput").value)
      );

      /* ===========================================================
       6) JSON Formatter/Validator
    ============================================================ */
      const jIn = $("#jsonInput"),
        jOut = $("#jsonOutput"),
        jStatus = $("#jsonStatus");
      const setJ = (msg, ok = true) => {
        jStatus.textContent = msg;
        jStatus.style.color = ok ? "var(--ok)" : "var(--danger)";
      };
      $("#jsonFormat").addEventListener("click", () => {
        try {
          const o = JSON.parse(jIn.value);
          jOut.value = JSON.stringify(o, null, 2);
          setJ("Valid JSON • Formatted", true);
        } catch (e) {
          jOut.value = "";
          setJ("Invalid JSON: " + e.message, false);
        }
      });
      $("#jsonMinify").addEventListener("click", () => {
        try {
          const o = JSON.parse(jIn.value);
          jOut.value = JSON.stringify(o);
          setJ("Valid JSON • Minified", true);
        } catch (e) {
          jOut.value = "";
          setJ("Invalid JSON: " + e.message, false);
        }
      });
      $("#jsonValidate").addEventListener("click", () => {
        try {
          JSON.parse(jIn.value);
          setJ("Valid JSON ✔", true);
        } catch (e) {
          setJ("Invalid JSON: " + e.message, false);
        }
      });
      $("#jsonCopy").addEventListener("click", () => copy(jOut.value));

      /* ===========================================================
       7) Password Generator (crypto-secure)
    ============================================================ */
      const rng = (n) => {
        const a = new Uint32Array(n);
        crypto.getRandomValues(a);
        return a;
      };
      const pick = (arr) =>
        arr[
          Math.floor(
            (crypto.getRandomValues(new Uint32Array(1))[0] / 2 ** 32) *
              arr.length
          )
        ];
      const sets = {
        lower: "abcdefghijklmnopqrstuvwxyz".split(""),
        upper: "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),
        num: "0123456789".split(""),
        sym: "!@#$%^&*()-_=+[]{};:,.<>?/|~".split(""),
      };
      const generatePassword = () => {
        const len = +$("#pwLen").value;
        const use = [];
        if ($("#pwLower").checked) use.push(sets.lower);
        if ($("#pwUpper").checked) use.push(sets.upper);
        if ($("#pwNum").checked) use.push(sets.num);
        if ($("#pwSym").checked) use.push(sets.sym);
        if (!use.length) {
          use.push(sets.lower, sets.num);
        }
        // ensure at least one from each
        const out = [];
        use.forEach((set) => out.push(pick(set)));
        const flat = use.flat();
        const need = len - out.length;
        const bytes = rng(need);
        for (let i = 0; i < need; i++) {
          out.push(flat[bytes[i] % flat.length]);
        }
        // shuffle (Fisher–Yates)
        for (let i = out.length - 1; i > 0; i--) {
          const j = rng(1)[0] % (i + 1);
          [out[i], out[j]] = [out[j], out[i]];
        }
        return out.join("");
      };
      $("#pwLen").addEventListener(
        "input",
        (e) => ($("#pwLenVal").textContent = e.target.value)
      );
      $("#pwGen").addEventListener(
        "click",
        () => ($("#pwOut").value = generatePassword())
      );
      $("#pwCopy").addEventListener("click", () => copy($("#pwOut").value));
      $("#pwOut").value = generatePassword();

      /* ===========================================================
       8) UUID v4
    ============================================================ */
      const uuidv4 = () => {
        const a = new Uint8Array(16);
        crypto.getRandomValues(a);
        a[6] = (a[6] & 0x0f) | 0x40; // version 4
        a[8] = (a[8] & 0x3f) | 0x80; // variant
        const b = [...a].map(
          (v, i) =>
            (i === 4 || i === 6 || i === 8 || i === 10 ? "-" : "") +
            v.toString(16).padStart(2, "0")
        );
        return b.join("").replace(/^-/, "");
      };
      $("#uuidGen").addEventListener(
        "click",
        () => ($("#uuidOut").value = uuidv4())
      );
      $("#uuidCopy").addEventListener("click", () => copy($("#uuidOut").value));
      $("#uuidOut").value = uuidv4();

      /* ===========================================================
       9) Hash Generator (SHA-256)
    ============================================================ */
      const toHex = (buf) =>
        [...new Uint8Array(buf)]
          .map((b) => b.toString(16).padStart(2, "0"))
          .join("");
      const sha256 = async (data) => {
        const ab = typeof data === "string" ? textEncoder.encode(data) : data;
        const digest = await crypto.subtle.digest("SHA-256", ab);
        return toHex(digest);
      };
      $("#hashRun").addEventListener("click", async () => {
        const f = $("#hashFile").files[0];
        if (f) {
          const buf = await f.arrayBuffer();
          $("#hashOut").value = await sha256(buf);
        } else {
          $("#hashOut").value = await sha256($("#hashText").value);
        }
      });

      /* ===========================================================
       10) Image Resizer & Compressor
    ============================================================ */
      const img = $("#imgPreview"),
        imgCanvas = $("#imgCanvas"),
        ctx = imgCanvas.getContext("2d");
      let imgNaturalW = 0,
        imgNaturalH = 0;

      $("#imgFile").addEventListener("change", () => {
        const f = $("#imgFile").files[0];
        if (!f) return;
        const url = URL.createObjectURL(f);
        img.onload = () => {
          imgNaturalW = img.naturalWidth;
          imgNaturalH = img.naturalHeight;
          $("#imgW").value = imgNaturalW;
          $("#imgH").value = imgNaturalH;
          $(
            "#imgInfo"
          ).textContent = `Source: ${imgNaturalW}×${imgNaturalH} • ${humanBytes(
            f.size
          )}`;
          $("#imgEmpty").style.display = "none";
          img.style.display = "block";
          URL.revokeObjectURL(url);
        };
        img.src = url;
      });
      $("#imgKeep").addEventListener("change", () => {
        if (!imgNaturalW) return;
        if ($("#imgKeep").checked) {
          // lock ratio: when width changes, set height accordingly (handled on input handlers)
        }
      });
      $("#imgW").addEventListener("input", () => {
        if ($("#imgKeep").checked && imgNaturalW) {
          const r = imgNaturalH / imgNaturalW;
          $("#imgH").value = Math.round($("#imgW").value * r);
        }
      });
      $("#imgH").addEventListener("input", () => {
        if ($("#imgKeep").checked && imgNaturalH) {
          const r = imgNaturalW / imgNaturalH;
          $("#imgW").value = Math.round($("#imgH").value * r);
        }
      });
      $("#imgQ").addEventListener(
        "input",
        (e) => ($("#imgQVal").textContent = (+e.target.value).toFixed(2))
      );
      $("#imgAuto").addEventListener("click", () => {
        if (!imgNaturalW) return;
        $("#imgW").value = imgNaturalW;
        $("#imgH").value = imgNaturalH;
        $("#imgQ").value = 0.8;
        $("#imgQVal").textContent = "0.80";
      });

      $("#imgRun").addEventListener("click", () => {
        if (!imgNaturalW) {
          alert("Please upload an image first.");
          return;
        }
        const W = Math.max(1, parseInt($("#imgW").value || imgNaturalW, 10));
        const H = Math.max(1, parseInt($("#imgH").value || imgNaturalH, 10));
        const fmt = $("#imgFormat").value;
        const q = parseFloat($("#imgQ").value) || 0.8;

        imgCanvas.width = W;
        imgCanvas.height = H;
        ctx.clearRect(0, 0, W, H);
        // High-quality resizing
        ctx.imageSmoothingEnabled = true;
        ctx.imageSmoothingQuality = "high";
        ctx.drawImage(img, 0, 0, W, H);

        imgCanvas.toBlob(
          (blob) => {
            if (!blob) {
              alert("Failed to export image.");
              return;
            }
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            const ext = fmt.split("/")[1].replace("jpeg", "jpg");
            a.href = url;
            a.download = `image_${W}x${H}.${ext}`;
            document.body.appendChild(a);
            a.click();
            a.remove();
            $("#imgInfo").textContent = `Output: ${W}×${H} • ${humanBytes(
              blob.size
            )}`;
            URL.revokeObjectURL(url);
          },
          fmt,
          ["image/jpeg", "image/webp"].includes(fmt) ? q : undefined
        );
      });

      /* ===========================================================
       11) Color Picker + Contrast
    ============================================================ */
      const cFg = $("#cFg"),
        cBg = $("#cBg"),
        cFgHex = $("#cFgHex"),
        cBgHex = $("#cBgHex");
      const hexNorm = (h) => {
        let s = h.trim().toUpperCase();
        if (!s.startsWith("#")) s = "#" + s;
        if (s.length === 4)
          s = "#" + [...s.slice(1)].map((ch) => ch + ch).join("");
        return s.slice(0, 7);
      };
      const hexToRgb = (h) => {
        const x = parseInt(h.slice(1), 16);
        return { r: (x >> 16) & 255, g: (x >> 8) & 255, b: x & 255 };
      };
      const srgbToLin = (c) => {
        c /= 255;
        return c <= 0.04045 ? c / 12.92 : ((c + 0.055) / 1.055) ** 2.4;
      };
      const luminance = ({ r, g, b }) =>
        0.2126 * srgbToLin(r) + 0.7152 * srgbToLin(g) + 0.0722 * srgbToLin(b);
      const contrast = (fg, bg) => {
        const L1 = luminance(hexToRgb(fg)),
          L2 = luminance(hexToRgb(bg));
        const [hi, lo] = L1 >= L2 ? [L1, L2] : [L2, L1];
        return (hi + 0.05) / (lo + 0.05);
      };
      const updateContrast = () => {
        const fg = hexNorm(cFgHex.value),
          bg = hexNorm(cBgHex.value);
        cFg.value = fg;
        cBg.value = bg;
        cFgHex.value = fg;
        cBgHex.value = bg;
        $("#sampleA").style.color = fg;
        $("#sampleA").style.background = bg;
        $("#sampleB").style.color = fg;
        $("#sampleB").style.background = bg;
        const ratio = contrast(fg, bg);
        const r = ratio.toFixed(2);
        const passAAL = ratio >= 3,
          passAA = ratio >= 4.5,
          passAAAL = ratio >= 4.5,
          passAAA = ratio >= 7;
        $("#contrastResult").innerHTML = `
        Contrast ratio: <b class="mono">${r}:1</b>
        &nbsp;•&nbsp; <span class="${passAA ? "ok" : "bad"}">AA (normal): ${
          passAA ? "PASS" : "FAIL"
        }</span>
        &nbsp;•&nbsp; <span class="${passAAL ? "ok" : "bad"}">AA (large): ${
          passAAL ? "PASS" : "FAIL"
        }</span>
        &nbsp;•&nbsp; <span class="${passAAA ? "ok" : "bad"}">AAA (normal): ${
          passAAA ? "PASS" : "FAIL"
        }</span>
        &nbsp;•&nbsp; <span class="${passAAAL ? "ok" : "bad"}">AAA (large): ${
          passAAAL ? "PASS" : "FAIL"
        }</span>
      `;
      };
      [cFg, cBg, cFgHex, cBgHex].forEach((el) => {
        el.addEventListener("input", (e) => {
          if (e.target === cFg) cFgHex.value = cFg.value;
          if (e.target === cBg) cBgHex.value = cBg.value;
          updateContrast();
        });
      });
      $$(".tool-body button[data-copy]").forEach((btn) => {
        btn.addEventListener("click", () => copy($(btn.dataset.copy).value));
      });
      updateContrast();

      /* ===========================================================
       12) Stopwatch & Countdown
    ============================================================ */
      // Stopwatch
      let swStartTs = 0,
        swTimer = null,
        swElapsed = 0;
      const fmtMillis = (ms) => {
        const m = Math.floor(ms / 60000);
        const s = Math.floor((ms % 60000) / 1000);
        const x = ms % 1000;
        return `${String(m).padStart(2, "0")}:${String(s).padStart(
          2,
          "0"
        )}.${String(x).padStart(3, "0")}`;
      };
      const swTick = () => {
        const now = performance.now();
        $("#swDisplay").textContent = fmtMillis(swElapsed + (now - swStartTs));
        swTimer = requestAnimationFrame(swTick);
      };
      $("#swStart").addEventListener("click", () => {
        if (swTimer) return;
        swStartTs = performance.now();
        swTimer = requestAnimationFrame(swTick);
      });
      $("#swPause").addEventListener("click", () => {
        if (!swTimer) return;
        cancelAnimationFrame(swTimer);
        swTimer = null;
        swElapsed += performance.now() - swStartTs;
        $("#swDisplay").textContent = fmtMillis(swElapsed);
      });
      $("#swReset").addEventListener("click", () => {
        if (swTimer) cancelAnimationFrame(swTimer);
        swTimer = null;
        swElapsed = 0;
        $("#swDisplay").textContent = "00:00.000";
      });

      // Countdown
      let cdInt = null,
        cdLeft = 0;
      const fmtSec = (t) =>
        `${String(Math.floor(t / 60)).padStart(2, "0")}:${String(
          Math.floor(t % 60)
        ).padStart(2, "0")}`;
      const beep = () => {
        const ac = new (window.AudioContext || window.webkitAudioContext)();
        const o = ac.createOscillator();
        const g = ac.createGain();
        o.type = "sine";
        o.frequency.value = 880;
        o.connect(g);
        g.connect(ac.destination);
        o.start();
        g.gain.setValueAtTime(0.2, ac.currentTime);
        g.gain.exponentialRampToValueAtTime(0.0001, ac.currentTime + 0.6);
        o.stop(ac.currentTime + 0.65);
      };
      const cdUpdate = () => ($("#cdDisplay").textContent = fmtSec(cdLeft));
      $("#cdStart").addEventListener("click", () => {
        const m = Math.max(0, parseInt($("#cdMin").value || "0", 10));
        const s = Math.max(
          0,
          Math.min(59, parseInt($("#cdSec").value || "0", 10))
        );
        cdLeft = m * 60 + s;
        if (cdLeft <= 0) return;
        if (cdInt) clearInterval(cdInt);
        cdUpdate();
        cdInt = setInterval(() => {
          cdLeft--;
          cdUpdate();
          if (cdLeft <= 0) {
            clearInterval(cdInt);
            cdInt = null;
            beep();
            toast("Time up!");
          }
        }, 1000);
      });
      $("#cdStop").addEventListener("click", () => {
        if (cdInt) clearInterval(cdInt);
        cdInt = null;
      });

      /* ===========================================================
       13) Quick Notes (localStorage)
    ============================================================ */
      const NOTE_KEY = "tools-pack:notes:v1";
      const notes = $("#notesArea"),
        notesStatus = $("#notesStatus");
      notes.value = localStorage.getItem(NOTE_KEY) || "";
      let saveT = null;
      const saveNotes = () => {
        localStorage.setItem(NOTE_KEY, notes.value);
        notesStatus.textContent = "Saved " + new Date().toLocaleTimeString();
      };
      notes.addEventListener("input", () => {
        clearTimeout(saveT);
        saveT = setTimeout(saveNotes, 400);
      });
      $("#notesClear").addEventListener("click", () => {
        if (confirm("Clear all notes?")) {
          notes.value = "";
          saveNotes();
        }
      });
      $("#notesExport").addEventListener("click", () => {
        const blob = new Blob([notes.value], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "notes.txt";
        a.click();
        URL.revokeObjectURL(url);
      });
      $("#notesImportFile").addEventListener("change", async () => {
        const f = $("#notesImportFile").files[0];
        if (!f) return;
        const txt = await f.text();
        notes.value = txt;
        saveNotes();
      });

      /* ===========================================================
       Misc: Initialize palette list from DOM & hook global search on load
    ============================================================ */
      buildPalette("");
      filterCards("");

      /* ===========================================================
 14) Age Calculator
============================================================ */

      (() => {
        const dobEl = $("#ageDob");
        const asOfEl = $("#ageAsOf");
        const outEl = $("#ageOut");
        const nextEl = $("#ageNextVal");

        // NEW: open the native date picker if supported; otherwise focus/click
        const openPicker = (el) => {
          try {
            if (typeof el.showPicker === "function") {
              el.showPicker(); // Chrome/Edge/Opera (desktop + Android), some mobile browsers
            } else {
              el.focus();
              el.click(); // fallback that opens pickers on many browsers
            }
          } catch {
            el.focus();
            el.click();
          }
        };

        const todayStr = () => {
          const t = new Date();
          const y = t.getFullYear();
          const m = String(t.getMonth() + 1).padStart(2, "0");
          const d = String(t.getDate()).padStart(2, "0");
          return `${y}-${m}-${d}`;
        };

        const parseYMD = (s) => {
          const [y, m, d] = (s || "").split("-").map(Number);
          if (!y || !m || !d) return null;
          return { y, m, d };
        };
        const toLocalDate = ({ y, m, d }) => new Date(y, m - 1, d);
        const isLeap = (y) => (y % 4 === 0 && y % 100 !== 0) || y % 400 === 0;
        const daysBetween = (a, b) => {
          const A = Date.UTC(a.getFullYear(), a.getMonth(), a.getDate());
          const B = Date.UTC(b.getFullYear(), b.getMonth(), b.getDate());
          return Math.round((B - A) / 86400000);
        };

        const diffYMD = (birth, asof) => {
          let y = asof.y - birth.y;
          let m = asof.m - birth.m;
          let d = asof.d - birth.d;

          if (d < 0) {
            const prevMonthDays = new Date(asof.y, asof.m - 1, 0).getDate();
            d += prevMonthDays;
            m -= 1;
          }
          if (m < 0) {
            m += 12;
            y -= 1;
          }
          return { y, m, d };
        };

        const birthdayForYear = (dob, year) => {
          const m = dob.m === 2 && dob.d === 29 && !isLeap(year) ? 2 : dob.m;
          const d = dob.m === 2 && dob.d === 29 && !isLeap(year) ? 28 : dob.d;
          return new Date(year, m - 1, d);
        };

        const formatDate = (dt) =>
          dt.toLocaleDateString(undefined, {
            weekday: "long",
            year: "numeric",
            month: "short",
            day: "numeric",
          });

        const calculate = () => {
          const dob = parseYMD(dobEl.value);
          const asOf = parseYMD(asOfEl.value || todayStr());

          if (!dob) {
            outEl.value = "Please select your date of birth.";
            nextEl.textContent = "";
            // NEW: force the picker to open for DOB
            openPicker(dobEl);
            return;
          }
          if (!asOf) {
            outEl.value = "Please select an 'As of' date.";
            nextEl.textContent = "";
            // NEW: force the picker to open for As Of
            openPicker(asOfEl);
            return;
          }

          const dobD = toLocalDate(dob);
          const asOfD = toLocalDate(asOf);
          if (asOfD < dobD) {
            outEl.value = "Error: 'As of' date cannot be before date of birth.";
            nextEl.textContent = "";
            return;
          }

          const a = diffYMD(dob, asOf);
          const totalDays = daysBetween(dobD, asOfD);

          let nextBday = birthdayForYear(dob, asOf.y);
          if (daysBetween(asOfD, nextBday) < 0)
            nextBday = birthdayForYear(dob, asOf.y + 1);
          const daysToNext = daysBetween(asOfD, nextBday);

          const turning = a.y + (daysToNext === 0 ? 0 : 1);

          outEl.value =
            `Age: ${a.y} years, ${a.m} months, ${a.d} days\n` +
            `Total days lived: ${totalDays.toLocaleString()}`;

          nextEl.textContent =
            daysToNext === 0
              ? `🎉 Today (${formatDate(nextBday)}) — turning ${a.y}!`
              : `${daysToNext} day${
                  daysToNext === 1 ? "" : "s"
                } — on ${formatDate(nextBday)} (turning ${turning})`;
        };

        // Wire up
        $("#ageCalc").addEventListener("click", calculate);
        $("#ageReset").addEventListener("click", () => {
          dobEl.value = "";
          asOfEl.value = todayStr();
          outEl.value = "";
          nextEl.textContent = "";
          // OPTIONAL: after reset, immediately open DOB picker so user picks date
          openPicker(dobEl);
        });
        $("#ageCopy").addEventListener("click", () => {
          if (outEl.value)
            copy(outEl.value + "\nNext birthday: " + nextEl.textContent);
        });

        // Defaults / limits
        const today = todayStr();
        asOfEl.value = today;
        dobEl.max = today;
        asOfEl.max = today;

        // NEW: make clicking/focusing the inputs always open the picker
        const bindAutoPicker = (el) => {
          // Click opens picker
          el.addEventListener("click", () => openPicker(el));
          // Focus (keyboard/tab) opens picker
          el.addEventListener("focus", () => openPicker(el));
          // Prevent some browsers from showing keyboard instead
          el.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              openPicker(el);
            }
          });
        };
        bindAutoPicker(dobEl);
        bindAutoPicker(asOfEl);

        // Allow Enter to trigger calculate
        [dobEl, asOfEl].forEach((el) =>
          el.addEventListener("keydown", (e) => {
            if (e.key === "Enter") calculate();
          })
        );
      })();

      /* ===========================================================
 Text → PDF (overlay print — no popups/iframes)
============================================================ */
      (() => {
        if (!$("#tool-pdf")) return; // only wire up if the card exists

        const fnEl = $("#pdfFileName");
        const pageEl = $("#pdfPage");
        const orientEl = $("#pdfOrient");
        const fontEl = $("#pdfFont");
        const sizeEl = $("#pdfSize");
        const marginEl = $("#pdfMargin");
        const lineEl = $("#pdfLine");
        const headerOnEl = $("#pdfHeaderOn");
        const footerOnEl = $("#pdfFooterOn");
        const textEl = $("#pdfText");
        const statusEl = $("#pdfStatus");

        // defaults
        fnEl.value ||= "document.pdf";
        if (!pageEl.value) pageEl.value = "A4";
        if (!orientEl.value) orientEl.value = "portrait";

        const escapeHtml = (s) =>
          s.replace(
            /[&<>]/g,
            (ch) => ({ "&": "&amp;", "<": "&lt;", ">": "&gt;" }[ch])
          );

        const fontFamilyFor = (v) =>
          v === "serif"
            ? "Georgia, 'Times New Roman', serif"
            : v === "monospace"
            ? "ui-monospace, SFMono-Regular, Menlo, Consolas, 'Liberation Mono', monospace"
            : "system-ui, -apple-system, Segoe UI, Roboto, Inter, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif";

        const gather = () => ({
          filename: (fnEl.value || "document.pdf").trim(),
          page: pageEl.value,
          orient: orientEl.value,
          font: fontEl.value,
          size: Math.max(8, Math.min(24, +sizeEl.value || 12)),
          margin: Math.max(5, Math.min(40, +marginEl.value || 15)),
          lh: Math.max(1, Math.min(2.4, +lineEl.value || 1.5)),
          headerOn: headerOnEl.checked,
          footerOn: footerOnEl.checked,
          body: textEl.value || "",
        });

        const buildOverlayHTML = (vals) => {
          const title = (vals.filename || "document.pdf").replace(
            /\.pdf$/i,
            ""
          );
          const header = vals.headerOn
            ? `<header style="margin:0 0 12px 0;font-size:${Math.max(
                10,
                vals.size - 2
              )}pt;color:#555">${escapeHtml(title)}</header>`
            : "";
          const footer = vals.footerOn
            ? `<footer style="margin:12px 0 0 0;font-size:${Math.max(
                9,
                vals.size - 3
              )}pt;color:#777">Generated on ${new Date().toLocaleString()}</footer>`
            : "";
          return `
      ${header}
      <div class="tp-container">${escapeHtml(vals.body)}</div>
      ${footer}
    `;
        };

        const openPrint = () => {
          const v = gather();
          if (!v.body.trim()) {
            statusEl.textContent = "Please enter some text first.";
            statusEl.style.color = "var(--danger)";
            setTimeout(() => (statusEl.style.color = "var(--muted)"), 1400);
            return;
          }

          // 1) Create a print-only root
          const root = document.createElement("div");
          root.id = "tp-print-root";
          root.setAttribute("aria-hidden", "true");
          root.innerHTML = buildOverlayHTML(v);
          document.body.appendChild(root);

          // 2) Inject print CSS (page size, margins, fonts, hide rest of app)
          const style = document.createElement("style");
          style.id = "tp-print-style";
          style.textContent = `
      /* page setup */
      @page { size: ${v.page} ${v.orient}; margin: ${v.margin}mm; }

      /* screen: keep it hidden; print: show only overlay */
      #tp-print-root { display: none; background: #fff; color: #000; }
      @media screen {
        #tp-print-root { display: none; }
      }
      @media print {
        body { background: #fff !important; }
        body > *:not(#tp-print-root) { display: none !important; }
        #tp-print-root {
          display: block !important;
          font-family: ${fontFamilyFor(v.font)};
          font-size: ${v.size}pt;
          line-height: ${v.lh};
          margin: 0;
          padding: 0;
        }
        #tp-print-root .tp-container {
          white-space: pre-wrap;
          word-break: break-word;
          min-height: 60vh;
        }
      }
    `;
          document.head.appendChild(style);

          // 3) Print (from same window = no popup blockers)
          // Small delay lets layout settle
          setTimeout(() => {
            window.print();
            // 4) Clean up after print (give browser a moment)
            setTimeout(() => {
              style.remove();
              root.remove();
            }, 500);
          }, 50);
        };

        $("#pdfPreview").addEventListener("click", openPrint);
        $("#pdfClear").addEventListener("click", () => {
          textEl.value = "";
          statusEl.textContent = "Cleared.";
          statusEl.style.color = "var(--muted)";
        });
        $("#pdfSample").addEventListener("click", () => {
          textEl.value = `Tools Pack — Text → PDF

✓ Works with Bangla (বাংলা), emoji 😄, Arabic العربية, etc.
✓ Choose page size, orientation, margins, font, and line height.
✓ Click “Preview & Print” → choose “Save as PDF”.`;
          statusEl.textContent = "Sample inserted.";
        });
      })();
    </script>

    word sentence_no sentence
  </body>
</html>
